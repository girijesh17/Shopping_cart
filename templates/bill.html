<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Sales Bill/Receipt</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Creative touch: Monospaced font for receipt look */
        .receipt-container {
            max-width: 500px;
            margin: 50px auto;
            padding: 30px;
            border: 1px solid #ddd;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            font-family: 'Courier New', Courier, monospace;
        }
        .bill-header, .bill-footer {
            text-align: center;
        }
        .bill-divider {
            border-top: 1px dashed #333;
            margin: 10px 0;
        }
    </style>
</head>
<body class="bg-light">

    <div class="receipt-container">
        <div class="bill-header">
            <h3>{{ shop_name }}</h3> <p class="small mb-0">123, Innovation Street, Digital City</p>
            <p class="small">Contact: (012) 345-6789</p>
            <div class="bill-divider"></div>
        </div>

        <p class="mb-1"><strong>Invoice ID:</strong> {{ invoice_id }}</p>
        <p class="mb-1"><strong>Date & Time:</strong> {{ date_time }}</p>
        <p class="mb-3"><strong>Customer Name:</strong> {{ customer_name }}</p>
        <div class="bill-divider"></div>

        <table class="table table-sm table-borderless small mb-0">
            <thead>
                <tr>
                    <th style="width: 50%;">Item</th>
                    <th style="width: 15%;" class="text-end">Qty</th>
                    <th style="width: 20%;" class="text-end">Price</th>
                    <th style="width: 15%;" class="text-end">Total</th>
                </tr>
            </thead>
            <tbody>
                {% for item in cart %}
                <tr>
                    <td>{{ item.name }}</td>
                    <td class="text-end">{{ item.quantity }}</td>
                    <td class="text-end">{{ "{:,.2f}".format(item.price) }}</td>
                    <td class="text-end">{{ "{:,.2f}".format(item.price * item.quantity) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <div class="bill-divider"></div>

        <table class="table table-sm table-borderless small mb-0">
            <tbody>
                <tr>
                    <td><strong>SUBTOTAL:</strong></td>
                    <td class="text-end">₹ {{ "{:,.2f}".format(subtotal) }}</td>
                </tr>
                {% if discount > 0 %}
                <tr class="text-danger">
                    <td><strong>Discount ({{ discount_rate }}%):</strong></td>
                    <td class="text-end">- ₹ {{ "{:,.2f}".format(discount) }}</td>
                </tr>
                {% endif %}
                <tr>
                    <td><strong>Taxable Amount:</strong></td>
                    <td class="text-end">₹ {{ "{:,.2f}".format(subtotal - discount) }}</td>
                </tr>
                <tr>
                    <td><strong>Tax (GST @ {{ tax_rate }}%):</strong></td>
                    <td class="text-end">+ ₹ {{ "{:,.2f}".format(tax) }}</td>
                </tr>
                <tr class="table-dark">
                    <td class="fw-bold">GRAND TOTAL:</td>
                    <td class="text-end fw-bold">₹ {{ "{:,.2f}".format(final_total) }}</td>
                </tr>
            </tbody>
        </table>
        <div class="bill-divider"></div>

        <div class="bill-footer">
            <p class="mt-3">*** THANK YOU FOR SHOPPING AT {{ shop_name|upper }}! ***</p> 
            <button onclick="window.print()" class="btn btn-success btn-sm me-2">Print Receipt</button>
            <a href="{{ url_for('clear_cart') }}" class="btn btn-primary btn-sm">New Transaction</a>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>